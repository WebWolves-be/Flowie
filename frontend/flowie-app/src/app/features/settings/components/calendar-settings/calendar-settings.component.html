@if (isLoadingFeedUrl()) {
  <div class="animate-pulse">
    <div class="mb-6">
      <div class="h-4 bg-gray-200 rounded w-32 mb-2"></div>
      <div class="h-10 bg-gray-200 rounded w-full"></div>
    </div>
    <div class="mb-6">
      <div class="h-4 bg-gray-200 rounded w-40 mb-2"></div>
      <div class="h-20 bg-gray-200 rounded w-full"></div>
    </div>
  </div>
} @else {
  <div class="space-y-6">
    <div>
      <h2 class="text-lg font-semibold text-gray-900 mb-4">Agenda feed</h2>
      <p class="text-sm text-gray-600 mb-6">
        Abonneer je op deze agenda feed om je taakdeadlines automatisch te synchroniseren met je agenda-app (Outlook, Google Calendar, Apple Calendar).
      </p>
    </div>

    @if (errorMessage()) {
      <div class="flex gap-3 p-4 bg-red-50 border border-red-200 rounded-lg">
        <svg class="h-5 w-5 text-red-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <p class="text-sm text-red-800">{{ errorMessage() }}</p>
      </div>
    }

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">
        Feed URL
      </label>
      <div class="flex gap-2">
        <input
          type="text"
          readonly
          [value]="feedUrl() || ''"
          class="flex-1 rounded-lg px-3 py-2 text-sm border border-gray-300 bg-gray-50 text-gray-700 focus:outline-none"
        />
        <button
          (click)="copyToClipboard()"
          [disabled]="!feedUrl()"
          class="px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-medium hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed">
          Kopieer
        </button>
      </div>
    </div>

    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
      <h3 class="text-sm font-semibold text-blue-900 mb-3">Hoe te gebruiken</h3>
      <div class="space-y-3 text-sm text-blue-800">
        <div>
          <p class="font-medium mb-1">Outlook:</p>
          <p>Ga naar Agenda → Agenda toevoegen → Vanaf internet → Plak de URL</p>
        </div>
        <div>
          <p class="font-medium mb-1">Google Calendar:</p>
          <p>Instellingen → Agenda's toevoegen → Vanaf URL → Plak de URL</p>
        </div>
        <div>
          <p class="font-medium mb-1">Apple Calendar:</p>
          <p>Bestand → Nieuwe agenda-abonnement → Plak de URL</p>
        </div>
      </div>
    </div>

    <div class="pt-4 border-t border-gray-200">
      <button
        (click)="regenerateToken()"
        [disabled]="isRegenerating()"
        class="px-4 py-2 rounded-lg border border-gray-300 text-gray-700 text-sm font-medium hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
        @if (isRegenerating()) {
          <span>Vernieuwen...</span>
        } @else {
          <span>URL vernieuwen</span>
        }
      </button>
      <p class="text-xs text-gray-500 mt-2">
        Let op: Het vernieuwen van de URL maakt de oude URL ongeldig. Je moet de nieuwe URL opnieuw toevoegen aan je agenda-app.
      </p>
    </div>
  </div>
}
